update_notifications = (id, count) ->
  $("#{id} .notification_count").html(count) if count isnt null 

  if parseInt($("#{id} .notification_count").html()) > 0
    $("#{id} .notification_count").show()
    $("#{id} i").addClass('icon-white')
  else
    $("#{id} .notification_count").hide()
    $("#{id} i").removeClass('icon-white')

window.update_messages_notifications = (count) ->
  update_notifications('#messages_notifications', count)

window.update_general_notifications = (count) ->
  update_notifications('#general_notifications', count)  

confirm_form_changed = false

window.confirm_unload = ->
  confirm_form_changed = true
  
  
check_confirm_unload = ->  
  if confirm_form_changed  
    return "<%= I18n.t 'js.confirm_unload' %>";  

$ ->
  update_messages_notifications()
  update_general_notifications()
  window.onbeforeunload = check_confirm_unload
