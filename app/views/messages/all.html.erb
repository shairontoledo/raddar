<% page_title t('message.p') %>

<div class="page-header">
  <h1><%= t('message.p') %></h1>
</div>

<div class="row">
  <div class="span8 offset2">
    <ul class="unstyled" id="all_chats">
      <% @messages.each do |message| %>
        <% user = (message.sender_id == current_user.id) ? message.recipient : message.sender %>
        <li class="clearfix <%= 'unread' if (message.sender_id != current_user.id) && (message.recipient_status == :unread) %>">
          <%= link_to image_tag(user.image.thumb.url, :class => 'size20'), user %>
          <%= link_to user_messages_path(user) do %>
            <%= truncate hide_html(message.content), length: 50, separator: ' ' %>
          <% end %>
        </li>
      <% end %>
    </ul>
    <%= will_paginate @messages %>
  </div>
</div>